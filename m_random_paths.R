#######################################################################
#######################################################################
#######################################################################
#######################################################################
#### Gloria Buritic√°
#### 
#### Simulation multivariate EV models
####
#######################################################################
#######################################################################
#######################################################################
#######################################################################
## MULTIVARIATE ARMAX
library(evd)
#path <- mARMAX1(al=4,par0=c(0.7,0.7,0.8),n0=1000,dep0=0.5,d0=3) 

mARMAX1 <- function(al=1, par0=seq(0.5,3), n0, dep0=0.8, d0=3){
  fre <- rmvevd(n0,dep=dep0,model="log", d=d0, mar=c(1,1/al,1/al))
  MArmax <- rbind(NULL,fre[1,])
  for(i in 2:n0){ 
    MArmax <- rbind(MArmax, 
                    sapply( 1:d0, function(d) max( par0[d]*MArmax[(i-1),d], fre[i,d]*((1-par0[d]^al)^(1/al))   ))) 
  }
  
  return(MArmax)     
}

